<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ch√° de Casa Nova - Jennifer e Gabriel</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #0f1115;
      --card-bg: #1e2229;
      --text: #edf2f7;
      --muted: #a0aec0;
      --border: #3f495a; /* Clareie um pouco a borda para ficar vis√≠vel */
      --accent: #63b3ed;
      --accent-hover: #4299e1;
      --success: #48bb78;
      --btn-bg: #2d3748;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      color: var(--text);
      line-height: 1.6;
      background-color: var(--bg);
      background-image: 
        radial-gradient(circle at 50% 0%, rgba(99, 179, 237, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 100% 0%, rgba(159, 122, 234, 0.1) 0%, transparent 40%);
      background-attachment: fixed;
    }

    main {
      max-width: 1200px; 
      margin: 0 auto;
      padding: 24px 16px;
    }

    header {
      text-align: center;
      margin-bottom: 32px;
      padding-top: 10px;
    }

    .event-type {
      text-transform: uppercase;
      letter-spacing: 3px;
      font-size: 0.9rem;
      color: var(--accent);
      font-weight: 600;
      margin-bottom: 10px;
    }

    h1 {
      margin: 0 0 20px 0;
      font-family: 'Great Vibes', cursive;
      font-size: 4rem;
      font-weight: 400;
      background: linear-gradient(to right, #fff, #a5b4fc);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      line-height: 1.4;
      padding: 10px 0;
      text-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    .subtitle {
      color: var(--muted);
      font-size: 0.95rem;
      margin-top: 16px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    /* --- CARROSSEL --- */
    .carousel-container {
      width: 100%;
      max-width: 500px;
      aspect-ratio: 4/3.3;
      margin: 0 auto 30px;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 15px 30px rgba(0,0,0,0.4);
      border: 1px solid var(--border);
      position: relative;
    }

    .carousel-track {
      display: flex;
      width: 100%;
      height: 100%;
      transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1);
    }

    .carousel-slide { min-width: 100%; height: 100%; }
    .carousel-slide img { width: 100%; height: 100%; object-fit: cover; }

    .nav-btn {
      position: absolute; top: 50%; transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.4); color: white; border: none;
      width: 40px; height: 40px; border-radius: 50%; cursor: pointer;
      z-index: 10; display: flex; align-items: center; justify-content: center;
      font-size: 20px; transition: background 0.3s; user-select: none;
    }
    .nav-btn:hover { background: rgba(0, 0, 0, 0.7); }
    .nav-prev { left: 10px; }
    .nav-next { right: 10px; }

    /* --- LAYOUT GRID --- */
    .controls {
      display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; margin-bottom: 24px;
      background: rgba(30, 34, 41, 0.6); backdrop-filter: blur(10px);
      padding: 16px; border-radius: 12px; border: 1px solid var(--border);
    }
    input[type="text"] {
      padding: 10px 14px; border-radius: 8px; border: 1px solid var(--border);
      background: rgba(0,0,0,0.3); color: var(--text); flex: 1; min-width: 200px; font-size: 1rem;
    }
    input[type="text"]:focus { outline: none; border-color: var(--accent); }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 20px;
    }

    /* --- CART√ÉO (CARD) --- */
    .card {
      background: var(--card-bg);
      /* Borda ao redor do cart√£o agora mais vis√≠vel */
      border: 1px solid rgba(255, 255, 255, 0.15); 
      border-radius: 16px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .card:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.3); border-color: var(--accent); }

    /* IMAGEM DO PRODUTO */
    .card-thumb {
      width: 100%;
      height: 200px;
      /* "contain" faz a imagem caber inteira sem cortar */
      object-fit: contain; 
      border-bottom: 1px solid var(--border);
      background: #fff;
      padding: 10px; /* Um respiro para a imagem n√£o colar na borda */
    }

    .card-content { padding: 16px; flex: 1; } /* Reduzi um pouco o padding interno */

    /* T√çTULO AJUSTADO */
    .card-title {
      font-size: 1.1rem; /* Diminui de 1.25 para 1.1 */
      font-weight: 700;
      margin: 0 0 10px;
      color: #fff;
      line-height: 1.3;
    }

    .badge { display: inline-flex; padding: 4px 10px; border-radius: 6px; background: rgba(99, 179, 237, 0.15); color: var(--accent); font-size: 0.8rem; font-weight: 600; margin-bottom: 12px; border: 1px solid rgba(99, 179, 237, 0.2); }
    
    .link-group { display: flex; flex-direction: column; gap: 8px; margin-top: 8px; }
    .link-btn { display: block; padding: 8px 12px; background: var(--btn-bg); color: var(--text); text-decoration: none; border-radius: 8px; font-size: 0.85rem; text-align: center; border: 1px solid transparent; transition: 0.2s;}
    .link-btn:hover { background: #3e4c63; }
    .link-btn span { opacity: 0.8; font-size: 0.8em; margin-left: 6px; }

    /* A√á√ÉO / RODAP√â DO CARD */
    .card-actions {
      background: rgba(0,0,0,0.2);
      padding: 14px 16px;
      /* Linha divis√≥ria interna refor√ßada */
      border-top: 1px solid rgba(255, 255, 255, 0.1); 
      display: flex; flex-direction: column; gap: 10px;
    }
    
    .check-label { display: flex; align-items: center; gap: 10px; cursor: pointer; font-weight: 500; color: var(--muted); user-select: none; font-size: 0.9rem; }
    .check-label input { width: 16px; height: 16px; accent-color: var(--success); }
    
    .btn-save { width: 100%; padding: 8px; border-radius: 8px; border: none; font-weight: 700; cursor: pointer; background: var(--accent); color: #1a202c; transition: 0.2s; font-size: 0.9rem; }
    .btn-save:hover { background: var(--accent-hover); }
    .btn-save:disabled { opacity: 0.6; cursor: not-allowed; }
    
    .who-info { font-size: 0.75rem; color: var(--muted); text-align: center; min-height: 1.2em; }
    #status { text-align: center; height: 24px; color: var(--accent); font-weight: 600; margin-bottom: 10px; }
  </style>
</head>
<body>
<main>
  
  <header>
    <div class="event-type">Ch√° de Casa Nova</div>
    <h1>Jennifer & Gabriel</h1>
    
    <div class="carousel-container">
      
      <button class="nav-btn nav-prev" onclick="prevSlide()">&#10094;</button>
      
<div class="carousel-track" id="track">
        
        <div class="carousel-slide">
          <img src="https://i.ibb.co/fz5hcfw4/Whats-App-Image-2026-02-04-at-11-54-343457.jpg" style="object-position: center;" alt="Casal">
        </div>
  
        <div class="carousel-slide">
          <img src="https://i.ibb.co/XfYw8nJ7/Whats-App-Image-2026-02-04-at-11-35-25.jpg" style="object-position: center;" alt="Nen√™">
        </div>
  
        <div class="carousel-slide">
          <img src="https://i.ibb.co/BKcp3fPW/Whats-App-Image-2026-02-0344-at-11-35-25.jpg" style="object-position: center;" alt="Salafodida">
        </div>
  
        <div class="carousel-slide">
          <img src="https://i.ibb.co/B5FpTFMb/Whats-App-Image-2026-02-04-at-11-33-55.jpg" style="object-position: top;" alt="Guitas">
        </div>

        <div class="carousel-slide">
          <img src="https://i.ibb.co/LD5tmrHM/Whats-App-Image-2026-02-04-at-11-30-47.jpg" style="object-position: center;" alt="Exterior">
        </div>

        <div class="carousel-slide">
          <img src="https://i.ibb.co/Q3bm1j5w/Whats-App-Image-2026-02-04-at-11-30-30.jpg" style="object-position: bottom;" alt="Sala">
        </div>

        <div class="carousel-slide">
          <img src="https://i.ibb.co/6RRfMxV7/Whats-App-Image-2026-02-04-at-11-35-235.jpg" style="object-position: center;" alt="Nen√™2">
        </div>

        <div class="carousel-slide">
          <img src="https://i.ibb.co/DDKfVMtp/Whats-App-Image-2026-02-04-at-11-59-45.jpg" style="object-position: bottom;" alt="Sala2">
        </div>

        <div class="carousel-slide">
          <img src="https://i.ibb.co/sJXVwhFR/Whats-App-Image-2026-02-252504-at-11-56-51.jpg" style="object-position: center;" alt="Casal2">
        </div>

      </div>

      <button class="nav-btn nav-next" onclick="nextSlide()">&#10095;</button>

    </div>
    <p class="subtitle">
      Estamos montando nosso cantinho! Selecione um item abaixo para nos presentear.
      <br><small style="opacity: 0.7">(Sua marca√ß√£o √© salva automaticamente na nossa lista)</small>
    </p>
  </header>

  <div class="controls">
    <input id="who" type="text" placeholder="Seu nome (Opcional)" />
    <button id="reload" class="btn-save" style="width: auto; padding: 0 20px; background: var(--btn-bg); color: #fff;">üîÑ Atualizar</button>
  </div>

  <p id="status"></p>
  <section id="grid" class="grid"></section>
</main>

<script>
  // --- L√ìGICA DO CARROSSEL MANUAL E AUTOM√ÅTICO ---
  const track = document.getElementById('track');
  const slides = document.querySelectorAll('.carousel-slide');
  let index = 0;
  let autoPlayInterval;

  function updateTrack() {
    track.style.transform = `translateX(-${index * 100}%)`;
  }

  function nextSlide() {
    index++;
    if(index >= slides.length) index = 0;
    updateTrack();
    resetTimer(); // Reinicia o timer se o usu√°rio clicou
  }

  function prevSlide() {
    index--;
    if(index < 0) index = slides.length - 1;
    updateTrack();
    resetTimer(); // Reinicia o timer se o usu√°rio clicou
  }

  // Fun√ß√£o para rodar o autom√°tico
  function startTimer() {
    autoPlayInterval = setInterval(() => {
      index++;
      if(index >= slides.length) index = 0;
      updateTrack();
    }, 3500);
  }

  // Fun√ß√£o para limpar e reiniciar o timer (para n√£o pular foto na cara do usu√°rio)
  function resetTimer() {
    clearInterval(autoPlayInterval);
    startTimer();
  }

  // Inicia o carrossel
  startTimer();

  // --- L√ìGICA DA LISTA (Google Sheets) ---
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycby3gfv-vwcfTY_g5jQ8-SIoqzac8OtQeZClMZCVczfD-emJXdHxowu9tWfHFDaojx17/exec";

  const grid = document.getElementById("grid");
  const statusEl = document.getElementById("status");
  const whoEl = document.getElementById("who");
  document.getElementById("reload").onclick = load;

  function setStatus(msg){ statusEl.textContent = msg || ""; }

  async function load(){
    setStatus("Buscando presentes...");
    grid.innerHTML = "";
    try{
      const r = await fetch(WEB_APP_URL, { cache: "no-store" });
      const j = await r.json();
      if(!j.ok) throw new Error(j.error || "Falha ao carregar");
      render(j.items || []);
      setStatus("");
    }catch(e){
      setStatus("Ops: " + e.message);
    }
  }

  function formatQuem(item){
    if(item.status !== "ok") return "";
    const who = (item.quem || "").trim();
    if(!who) return "Item j√° reservado! ‚úÖ";
    return "Reservado por: " + who + " ‚úÖ";
  }

  function makeLinkBtn(link, label, isSecondary){
    if(!link) return "";
    const text = label || "Ver na Loja";
    const icon = isSecondary ? "üîó" : "üéÅ"; 
    return `<a href="${link}" class="link-btn" target="_blank" rel="noopener">${icon} ${text} <span>‚Üó</span></a>`;
  }

  // Imagem "fake" para usar quando n√£o houver foto (Cinza escuro com texto claro)
  const PLACEHOLDER_IMG = "https://placehold.co/600x400/2d3748/a0aec0?text=Sem+Foto&font=montserrat";

  function render(items){
    items.forEach(item => {
      const card = document.createElement("article");
      card.className = "card";
      
      if(item.status === 'ok') {
        card.style.opacity = "0.75";
        card.style.borderColor = "var(--success)";
      }

      // --- BLOCO DE IMAGEM ATUALIZADO ---
      const img = document.createElement("img");
      img.className = "card-thumb";
      img.alt = item.titulo;
      
      // L√≥gica: Se tem link, usa ele. Se n√£o, usa o placeholder.
      if(item.imagem && item.imagem.trim() !== "") {
        img.src = item.imagem;
        // Se a imagem do link der erro (quebrada), substitui pelo placeholder
        img.onerror = function() { 
          this.src = PLACEHOLDER_IMG; 
          this.onerror = null; // evita loop infinito
        };
      } else {
        // Se a c√©lula estiver vazia na planilha
        img.src = PLACEHOLDER_IMG;
      }
      
      card.appendChild(img);
      // -----------------------------------

      const content = document.createElement("div");
      content.className = "card-content";

      const title = document.createElement("h2");
      title.className = "card-title";
      title.textContent = item.titulo || ("Item " + item.id);
      content.appendChild(title);

      if(item.cor){
        const badge = document.createElement("div");
        badge.className = "badge";
        badge.textContent = "üé® " + item.cor;
        content.appendChild(badge);
      }

      const linkGroup = document.createElement("div");
      linkGroup.className = "link-group";
      linkGroup.innerHTML = 
        makeLinkBtn(item.link1, item.link2 ? "Op√ß√£o 1" : "Ver Op√ß√£o de Compra") +
        makeLinkBtn(item.link2, "Op√ß√£o 2", true);
      content.appendChild(linkGroup);

      const actions = document.createElement("div");
      actions.className = "card-actions";
      const label = document.createElement("label");
      label.className = "check-label";
      const cb = document.createElement("input");
      cb.type = "checkbox";
      cb.checked = (item.status === "ok");
      const spanText = document.createElement("span");
      spanText.textContent = cb.checked ? "J√° comprei!" : "Marcar compra";
      
      cb.addEventListener('change', () => {
        spanText.textContent = cb.checked ? "J√° comprei!" : "Marcar compra";
        if(cb.checked) spanText.style.color = "var(--success)";
        else spanText.style.color = "var(--muted)";
      });

      label.appendChild(cb);
      label.appendChild(spanText);
      const saveBtn = document.createElement("button");
      saveBtn.className = "btn-save";
      saveBtn.textContent = "Salvar";
      const whoInfo = document.createElement("div");
      whoInfo.className = "who-info";
      whoInfo.textContent = formatQuem(item);

      saveBtn.onclick = async () => {
        saveBtn.disabled = true;
        saveBtn.textContent = "...";
        try{
          const payload = {
            id: String(item.id),
            status: cb.checked ? "ok" : "",
            quem: (whoEl.value || "").trim()
          };
          const r = await fetch(WEB_APP_URL, { method: "POST", body: JSON.stringify(payload) });
          const j = await r.json();
          if(!j.ok) throw new Error(j.error || "Erro");
          item.status = payload.status;
          item.quem = payload.quem;
          whoInfo.textContent = formatQuem(item);
          saveBtn.textContent = "‚úî";
          saveBtn.style.background = "var(--success)";
          if(item.status === 'ok') card.style.borderColor = "var(--success)";
          else card.style.borderColor = "var(--border)";
          setTimeout(() => {
            saveBtn.textContent = "Salvar";
            saveBtn.style.background = ""; 
            saveBtn.disabled = false;
          }, 2000);
        }catch(e){
          alert("Erro: " + e.message);
          saveBtn.textContent = "Salvar";
          saveBtn.disabled = false;
        }
      };

      actions.appendChild(label);
      actions.appendChild(saveBtn);
      actions.appendChild(whoInfo);
      card.appendChild(content);
      card.appendChild(actions);
      grid.appendChild(card);
    });
  }
      // --------------------------------------------------------

      const content = document.createElement("div");
      content.className = "card-content";

      const title = document.createElement("h2");
      title.className = "card-title";
      title.textContent = item.titulo || ("Item " + item.id);
      content.appendChild(title);

      if(item.cor){
        const badge = document.createElement("div");
        badge.className = "badge";
        badge.textContent = "üé® " + item.cor;
        content.appendChild(badge);
      }

      const linkGroup = document.createElement("div");
      linkGroup.className = "link-group";
      linkGroup.innerHTML = 
        makeLinkBtn(item.link1, item.link2 ? "Op√ß√£o 1" : "Ver Op√ß√£o de Compra") +
        makeLinkBtn(item.link2, "Op√ß√£o 2", true);
      content.appendChild(linkGroup);

      const actions = document.createElement("div");
      actions.className = "card-actions";
      const label = document.createElement("label");
      label.className = "check-label";
      const cb = document.createElement("input");
      cb.type = "checkbox";
      cb.checked = (item.status === "ok");
      const spanText = document.createElement("span");
      spanText.textContent = cb.checked ? "J√° comprei!" : "Marcar compra";
      
      cb.addEventListener('change', () => {
        spanText.textContent = cb.checked ? "J√° comprei!" : "Marcar compra";
        if(cb.checked) spanText.style.color = "var(--success)";
        else spanText.style.color = "var(--muted)";
      });

      label.appendChild(cb);
      label.appendChild(spanText);
      const saveBtn = document.createElement("button");
      saveBtn.className = "btn-save";
      saveBtn.textContent = "Salvar";
      const whoInfo = document.createElement("div");
      whoInfo.className = "who-info";
      whoInfo.textContent = formatQuem(item);

      saveBtn.onclick = async () => {
        saveBtn.disabled = true;
        saveBtn.textContent = "...";
        try{
          const payload = {
            id: String(item.id),
            status: cb.checked ? "ok" : "",
            quem: (whoEl.value || "").trim()
          };
          const r = await fetch(WEB_APP_URL, { method: "POST", body: JSON.stringify(payload) });
          const j = await r.json();
          if(!j.ok) throw new Error(j.error || "Erro");
          item.status = payload.status;
          item.quem = payload.quem;
          whoInfo.textContent = formatQuem(item);
          saveBtn.textContent = "‚úî";
          saveBtn.style.background = "var(--success)";
          if(item.status === 'ok') card.style.borderColor = "var(--success)";
          else card.style.borderColor = "var(--border)";
          setTimeout(() => {
            saveBtn.textContent = "Salvar";
            saveBtn.style.background = ""; 
            saveBtn.disabled = false;
          }, 2000);
        }catch(e){
          alert("Erro: " + e.message);
          saveBtn.textContent = "Salvar";
          saveBtn.disabled = false;
        }
      };

      actions.appendChild(label);
      actions.appendChild(saveBtn);
      actions.appendChild(whoInfo);
      card.appendChild(content);
      card.appendChild(actions);
      grid.appendChild(card);
    });
  }

  load();
</script>
</body>
</html>











